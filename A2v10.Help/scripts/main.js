(function() { 
/*GENERATED*/
const content = {
  "items": [
    {
      "title": "A2:SDK",
      "url": "/index",
      "items": [
        {
          "title": "Что нового",
          "url": "/whatsnew/index",
          "items": [
            {
              "title": "Февраль 2018",
              "url": "/whatsnew/w201802"
            }
          ]
        }
      ]
    },
    {
      "title": "Модели",
      "url": "/models/index",
      "items": [
        {
          "title": "Модели данных",
          "url": "/models/datamodels"
        },
        {
          "title": "model.json",
          "url": "/models/modelfile"
        }
      ]
    },
    {
      "title": "Представления",
      "url": "/views/index",
      "items": [
        {
          "title": "Xaml",
          "url": "/xaml/index",
          "items": [
            {
              "title": "Элементы управления",
              "url": "/xaml/controls/index",
              "items": [
                {
                  "title": "Button",
                  "url": "/xaml/controls/button"
                },
                {
                  "title": "Radio",
                  "url": "/xaml/controls/radio"
                },
                {
                  "title": "Checkbox",
                  "url": "/xaml/controls/checkbox"
                },
                {
                  "title": "MenuItem",
                  "url": "/xaml/controls/menuitem"
                },
                {
                  "title": "Selector",
                  "url": "/xaml/controls/selector"
                }
              ]
            },
            {
              "title": "Контейнеры",
              "url": "/xaml/containers/index",
              "items": [
                {
                  "title": "Block",
                  "url": "/xaml/containers/block"
                },
                {
                  "title": "Splitter",
                  "url": "/xaml/containers/splitter"
                },
                {
                  "title": "StackPanel",
                  "url": "/xaml/containers/stackpanel"
                },
                {
                  "title": "DropDownMenu",
                  "url": "/xaml/containers/dropdownmenu"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "title": "Контроллеры",
      "url": "/controllers/index",
      "items": [
        {
          "title": "Шаблоны",
          "url": "/template/index",
          "items": [
            {
              "title": "Свойства",
              "url": "/template/properties"
            },
            {
              "title": "События",
              "url": "/template/events"
            },
            {
              "title": "Команды",
              "url": "/template/commands"
            },
            {
              "title": "Валидаторы",
              "url": "/template/validators"
            }
          ]
        }
      ]
    },
    {
      "title": "О справочной системе",
      "url": "/app/about"
    }
  ]
}
;
const files = [{"url":"/index","title":"Платформа А2"},{"url":"/app/about","title":"О программе"},{"url":"/controllers/index","title":"Контроллеры"},{"url":"/models/datamodels","title":"Модели данных"},{"url":"/models/index","title":"Модели"},{"url":"/models/modelfile","title":"Файл model.json"},{"url":"/template/commands","title":"Шаблоны. Команды"},{"url":"/template/events","title":"Шаблоны. События"},{"url":"/template/index","title":"Шаблоны"},{"url":"/template/properties","title":"Шаблоны. Свойства"},{"url":"/template/validators","title":"Шаблоны. Валидаторы"},{"url":"/views/index","title":"Представления"},{"url":"/whatsnew/index","title":"Что нового"},{"url":"/whatsnew/w201802","title":"Что нового. Февраль 2018"},{"url":"/xaml/index","title":"Представления Xaml"},{"url":"/xaml/containers/block","title":"Xaml.Block"},{"url":"/xaml/containers/dropdownmenu","title":"Xaml.DropDownMenu"},{"url":"/xaml/containers/index","title":"XAML. Контейнеры"},{"url":"/xaml/containers/splitter","title":"Xaml.Splitter"},{"url":"/xaml/containers/stackpanel","title":"Xaml.StackPanel"},{"url":"/xaml/controls/button","title":"Xaml.Button"},{"url":"/xaml/controls/checkbox","title":"Xaml.CheckBox"},{"url":"/xaml/controls/index","title":"XAML. Элементы управления"},{"url":"/xaml/controls/menuitem","title":"Xaml.MenuItem"},{"url":"/xaml/controls/radio","title":"Xaml.Radio"},{"url":"/xaml/controls/selector","title":"Xaml.Selector"}];
const index = {"Block":[15],"Button":[20],"CheckBox":[21],"commands":[6],"Controls":[22],"DropDownMenu":[16],"events":[7],"MenuItem":[23],"model.json":[5],"properties":[9],"Radio":[24],"Selector":[25],"Splitter":[18],"StackPanel":[19],"template":[8],"validators":[10],"Валидаторы":[10],"Команды":[6],"Контейнеры":[17],"Модели":[4],"Модели данных":[3],"Свойства":[9],"События":[7],"Что нового":[12,13],"Шаблон":[8],"Элементы управления":[22]};
const fts = {"платформа":[0],"а2":[0,12],"версия":[0,1],"10":[0,1,12],"справочной":[1],"системе":[1],"справочная":[1],"система":[1],"создана":[1],"использованием":[1],"программного":[1],"обеспечения":[1],"открытым":[1],"исходным":[1],"кодом":[1],"vue.js":[1],"copyright":[1],"2014":[1],"2018":[1,12,13],"evan":[1],"you":[1],"домашняя":[1],"страница":[1],"лицензия":[1],"контроллеры":[2],"модели":[3,4,13],"данных":[3,13,22],"файл":[5,13],"model.json":[5,13],"шаблоны":[6,7,8,9,10,13],"команды":[6],"события":[7],"свойства":[9,15,16,18,19],"валидаторы":[10],"представления":[11,14],"нового":[12],"платформе":[12],"этом":[12],"разделе":[12],"описываются":[12],"последние":[12],"изменения":[12,22],"дополнения":[12],"программах":[12],"платформы":[12],"версии":[12,13],"текущий":[12],"номер":[12],"отображается":[12],"правом":[12],"нижнем":[12],"углу":[12],"окна":[12],"браузера":[12],"выпуск":[12,13],"1":[12,13],"февраль":[12,13],"7109":[13],"7116":[13],"выпуски":[13],"|":[13],"предыдущий":[13],"следующий":[13],"общие":[13],"исправлена":[13],"ошибка":[13],"которой":[13],"нельзя":[13],"было":[13],"очистить":[13],"фильтр":[13],"перезагрузки":[13],"страницы":[13],"добавлены":[13],"темы":[13],"пользовательского":[13],"интерфейса":[13],"модель":[13],"описания":[13],"параметры":[13],"моделей":[13],"действиях":[13],"actions":[13],"работала":[13],"локализация":[13],"включаемых":[13],"модулях":[13],"require":[13],"xaml":[13,14],"неправильно":[13],"работало":[13],"свойство":[13],"disabled":[13],"объекта":[13],"menuitem":[13,22,23],"элемент":[13,15,16,18,19,20,21,22,23,24,25],"dropdownmenu":[13,16,17],"теперь":[13],"поддерживает":[13],"itemssource":[13],"привязках":[13],"указанным":[13],"форматом":[13],"исправлено":[13],"правой":[13],"нижней":[13],"панели":[13,18],"splitter":[13,17,18],"можно":[13],"задавать":[13],"минимально":[13],"допустимую":[13],"ширину":[13],"только":[13],"чтение":[13],"запрещался":[13],"selector":[13,22,25],"добавлен":[13],"taglabel":[13],"tabindex":[13],"кнопок":[13],"button":[13,20,22],"радиокнопок":[13],"radio":[13,22,24],"флажков":[13],"checkbox":[13,21,22],"block":[15,17],"контейнеры":[15,16,17,18,19],"представляет":[15,16,18,19],"собой":[15,16,18,19],"контейнер":[15,18,19],"содержит":[15],"другие":[15],"элементы":[15,17,19,20,21,22,23,24,25],"управления":[15,20,21,22,23,24,25],"выпадающее":[16,17],"меню":[16,17,22],"контейнерные":[17],"используются":[17,22],"размещения":[17],"элементов":[17],"блок":[17],"разделитель":[17],"stackpanel":[17,19],"панель":[17],"содержащий":[18],"две":[18],"изменяемыми":[18],"размерами":[18],"присоединенные":[18],"котором":[19],"дочерние":[19],"выравниваются":[19],"одну":[19],"линию":[19],"ориентированную":[19],"вертикально":[19],"горизонтально":[19],"controls":[22],"ввода":[22],"отображения":[22],"кнопка":[22],"радиокнопка":[22],"флажок":[22],"селектор":[22]};
window.app = {content: content, files: files, index: index, fts: fts};
})();
// Copyright © 2017-2018 Alex Kukhtin. All rights reserved.

(function () {

	function doNavigate(event) {
		event.preventDefault();
		let route = this.getAttribute('data-route');
		window.vm.$emit('navigate', route);
	}

	function setHrefs(body) {
		let a = body.querySelectorAll('a');
		a.forEach(function (an) {
			let href = an.getAttribute('href');
			if (href.startsWith('http')) return; // external link
			an.setAttribute('href', '');
			an.setAttribute('data-route', href);
			an.addEventListener('click', doNavigate);
		});
	}

	function loadHtml(url) {
		return new Promise(function (resolve, reject) {
			let xhr = new XMLHttpRequest();
            xhr.onload = function () {
                if (xhr.responseText.startsWith('<!DOCTYPE')) {
                    let body = document.createElement("body");
                    let elem = document.createElement("div");
                    body.appendChild(elem);
                    elem.innerText = 'Not found';
                    resolve(body);
                }
                else {
                    let prs = new DOMParser();
                    let doc = prs.parseFromString(xhr.responseText, 'text/html');
                    let body = doc.body;
                    setHrefs(body);
                    resolve(body);
                }
			};
			xhr.open('GET', url, true);
			xhr.send();
		});
	}

	Vue.component('a2-include', {
		template: '<div class="content-view"></div>',
		props: {
			source: String
		},
		watch: {
			source: function (newSource, oldSource) {
				this.navigateTo(newSource);
			}
		},
		methods: {
			navigateTo(url) {
				let me = this;
				if (url === '/')
					url += 'index';
				//console.warn(url);
				loadHtml('/html' + url + '.html').then(function (elem) {
					me.$el.innerHTML = '';
					let div = document.createElement('div');
					let ch = elem.children;
                    let cha = [];
                    // for..of does not not for HtmlCollection in EDGE
                    let esrc = elem.children;
                    for (let i = 0; i < esrc.length; i++) {
						cha.push(esrc[i]);
					}
					for (ch of cha)
                        me.$el.appendChild(ch);
				});
			}
		}
	});

})();
// Copyright © 2017-2018 Alex Kukhtin. All rights reserved.

(function () {

    const treeItemComponent = {
        name: 'tree-item',
        template: `
<li :title="item.title" @click.stop.prevent="doClick(item)"
    :class="{expanded: isExpanded, collapsed:isCollapsed, active:isActive(item)}" >
    <div class="overlay">
        <a class="toggle" v-if="isFolder" href @click.stop.prevent="toggle"></a>
        <span v-else class="toggle"/>
        <i :class="iconClass"/>
        <a :href="dataHref" tabindex="-1" v-text="item.title"/>
    </div>
    <ul v-if="isFolder" v-show="isExpanded">
        <tree-item v-for="(itm, index) in item.items"
            :key="index" :item="itm" :click="click" :get-href="getHref" :is-active="isActive" :expand="expand" :root-items="rootItems"/>
    </ul>   
</li>
`,
        props: {
            item: Object,
            options: Object,
            rootItems: Array,
            /* callbacks */
            click: Function,
            expand: Function,
            isActive: Function,
            getHref: Function
        },
        methods: {
            doClick(item) {
                this.click(item);
            },
            toggle() {
                if (!this.isFolder)
                    return;
                Vue.set(this.item, "open" , !this.item.open);
            }
        },
        computed: {
            isFolder: function () {
                let ch = this.item.items;
                return ch && ch.length;
            },
            isExpanded: function () {
                return this.isFolder && this.item.open;
            },
            isCollapsed: function () {
                return this.isFolder && !this.item.open;
            },
            iconClass: function () {
                return "ico ico-" + (this.isFolder ? "node" : "leaf");
            },
            dataHref() {
                return this.getHref ? this.getHref(this.item) : '';
            }
        }
    };


    Vue.component('tree-view', {
        components: {
            'tree-item': treeItemComponent
        },
        template: `
<ul class="tree-view">
    <tree-item v-for="(itm, index) in items" :options="options" :get-href="getHref"
        :item="itm" :key="index"
        :click="click" :is-active="isActive" :expand="expand" :root-items="items">
    </tree-item>
</ul>
        `,
        props: {
            options: Object,
            items: Array,
            isActive: Function,
            click: Function,
            expand: Function,
            getHref: Function
        },
        computed: {
        },
        methods: {
        },
        created() {
        },
        updated() {
        }
    });

	Vue.component('a2-content-view', {
		template: '<div class="sub-side"><tree-view ref="treeView" :items="root.items" :click="navigate" :is-active="isActive" :get-href="getHRef"></tree-view></div>',
		data() {
			return {
				root: window.app.content
			};
        },
        computed: {
            currentUrl() {
                return window.location.pathname;
            }
        },
        methods: {
            navigate(item) {
                var vm = window.vm;
                vm.$emit('navigate', item.url);
                this.findActive(item.url);
            },
            isActive(item) {
                return item.active;
            },
            getHRef(item) {
                return item.url;
            },
            findActive(url) {

                function findOne(item) {
                    let active = item.url.toLowerCase() === url.toLowerCase();
                    Vue.set(item, 'active', active);
                    if (active)
                        document.title  = item.title;
                    if (!item.items) return;
                    item.items.forEach(findOne);
                    if (item.items.some((itm) => itm.active || itm.open)) {
                        Vue.set(item, 'open', true);
                    }
                }

                this.root.items.forEach(findOne);
            }
        },
        mounted() {
            const vm = window.vm;
            vm.$on('navigated', (url) => {
                //console.warn('navigated:' + url);
                this.findActive(url);
            });
        }
	});
})();
// Copyright © 2017-2018 Alex Kukhtin. All rights reserved.

(function () {



	Vue.component('a2-index-view', {
		template: `
<div class="sub-side">
    <div class="index-view">
        <div class="search-block">
            <label>Введите ключевое слово для поиска:</label>
            <input class="input-search" type=text v-model="fragment"></input>
        </div>
	    <ul class="index-tree">
		    <li v-for="(val, valIndex) in list">
                <a :class="{'active': isActive(val)}" v-if="val.files.length === 1" v-text="val.word" @click.stop.prevent="navigate(val, 0)"></a>
                <div v-else>
                    <span class="word-folder" v-text="val.word"></span>
                    <ul>
                        <li class="file-link" v-for="(itm, itmIndex) in val.files">
                            <a :class="{active: isActive(itm)}" v-text="itm.title" @click.stop.prevent="navigateFile(itm)"></a>
                        </li>
                    </ul>
                </div>
            </li>
	    </ul>
    </div>
</div>`,
/*
    <pre>list: {{active}}</pre>
	<pre v-once>{{root}}</pre><pre v-once>{{files}}</pre>
*/
		data() {
			return {
				root: window.app.index,
                files: window.app.files,
                active: null,
                fragment: ''
			};
        },
        computed: {
            list() {
                const f = this.fragment.toLowerCase();
                const root = this.root;
                const files = this.files;
                return Object.keys(this.root)
                    .filter(val => !f || val.toLowerCase().indexOf(f) !== -1)
                    .map(v => { return { word: v, files: root[v].map(f => files[f]) }; });
            }
        },
        methods: {
            isActive(itm) {
                return itm === this.active;
            },
			navigate(itm, ix) {
                var vm = window.vm;
                this.active = itm;
				vm.$emit('navigate', itm.files[ix].url);
			},
			navigateFile(itm) {
                var vm = window.vm;
                this.active = itm;
                vm.$emit('navigate', itm.url);
            }
        },
        mounted() {
        }
	});
})();
// Copyright © 2017-2018 Alex Kukhtin. All rights reserved.

(function () {

// {{key}} : {{res}} : {{res.length}}


    const debugMode = false;

	Vue.component('a2-search-view', {
		template: 
`<div class="sub-side">
    <div class="index-view">
	    <div class="search-block">
            <label>Введите слово для поиска:</label>
		    <input class="input-search" v-model.lazy="searchText">
            <a v-if="debugMode" @click="showDebug">debug</a>
	    </div>
        <ul class="debug-list" v-if="debugVisible">
            <li v-for="(res, key) in words" v-text="res"></li>
        </ul>
	    <ul class="index-tree" v-else>
		    <li v-for="(res, key) in searchResult">
                <a v-text="key" v-if="res.length == 1" 
                    :class="{active: isActive(res[0], key)}" 
                    @click.stop.prevent="navigate(res[0], key)"></a>
                <div v-else>
                    <span class="word-folder" v-text="key"></span>
                    <ul>
                        <li class="file-link" v-for="(ix) in res">
                            <a v-text="file(ix)" 
                                :class="{active: isActive(ix, key)}" 
                                @click.stop.prevent="navigate(ix, key)"></a>
                        </li>
                    </ul>
                </div>
            </li>
	    </ul>
    </div>
</div>`,
		data() {
			return {
                searchText: '',
                activeKey: '',
                activeIndex: 0,
                debugMode: debugMode,
                debugVisible: false
			};
		},
		watch: {
			searchText(newVal) {
			}
		},
        computed: {
            words() {
                let fts = window.app.fts;
                return Object.keys(fts);
            },
            searchResult() {
                let fts = window.app.fts;
                let r = {};
                if (!this.searchText) return r;
                let st = this.searchText.toUpperCase();
                for (let key in fts) {
                    if (key.toUpperCase().indexOf(st) !== -1)
                        r[key] = fts[key];
                }
				return r;
			}
		},
        methods: {
            file(ix) {
                let file = window.app.files[ix];
                return file ? file.title : '#ERR';
            },
            isActive(ix, key) {
                return ix === this.activeIndex && key === this.activeKey;
            },
			navigate(ix, key) {
                var vm = window.vm;
                this.activeKey = key;
                this.activeIndex = ix;
                vm.$emit('navigateFile', ix);
            },
            showDebug() {
                if (this.debugMode)
                    this.debugVisible = true;
            }
		}
	});
})();
// Copyright © 2017-2018 Alex Kukhtin. All rights reserved.

(function () {

	function makeUrl(url) {
		if (url.startsWith('/'))
			return url; // root-based
		let cUrl = window.location.pathname.split('/').filter(x => !!x);
		cUrl.splice(cUrl.length - 1, 1);
		let nUrl = url.split('/').filter(x => !!x);
		let xUrl = [];
		nUrl.forEach(x => {
			if (x === '..')
				cUrl.splice(cUrl.length - 1, 1);
			else
				xUrl.push(x);
		});
		let newUrl = cUrl.concat(xUrl);
		return '/' + newUrl.join('/');
	}

	const vm = new Vue({
		el: '#app',
		data: {
			content: '',
			activeTab: 'content'
		},
		methods: {
			navigate(url) {
                url = makeUrl(url);
                if (this.content === url)
                    return;
				window.history.pushState(null, null, url);
                this.content = url;
                this.$emit('navigated', this.content);
			},
			tab(name) {
				this.activeTab = name;
			},
			isActive(name) {
				return name === this.activeTab;
			}
		},
		created() {
			let me = this;
            window.vm = this;
			window.addEventListener('popstate', function () {
                me.content = window.location.pathname;
                me.$emit('navigated', me.content);
			}, false);

			this.$on('navigate', function (url) {
				me.navigate(url);
			});

            this.$on('navigateFile', function (index) {
				let files = window.app.files;
				let file = files[index];
				me.navigate(file.url);
			});
		},
		mounted() {
			let url = window.location.pathname;
			if (url === '/')
				url = '/index';
			this.navigate(url);
		}
    });
})();